{% extends 'base.html.twig' %}

{% block title %}Gestion du mat√©riel{% endblock %}

{% block body %}
    {# Stocker les messages flash dans des variables locales au d√©but du template #}
    {% set errorMessages = app.flashes('error') %}
    {% set successMessages = app.flashes('success') %}
    
    <div id="left1">
        <h1 class="page-h1">Gestion du mat√©riel</h1>
        <div class="main-type">
            {# Affichage des messages flash en haut de la page #}
            {% for message in errorMessages %}
                <div class="erreur info-container" style="margin-right:2rem !important">
                    <img src="/img/inscrit-standby.png" alt="" title="">
                    <div class="text-container">{{ message }}
                    </div>
                </div>
            {% endfor %}
            
            {% for message in successMessages %}
                <div class="info info-container" style="margin-right:2rem !important">
                    <img src="/img/inscrit-check.png" alt="" title="">
                    <div class="text-container">{{ message }}
                    </div>
                </div>
            {% endfor %}

            <p>
                Le club dispose de certains mat√©riels pour vous aider √† acc√©der aux activit√©s.
            </p>
            <p>
                Il vous est possible d'en louer via notre plateforme de r√©servation Loxya.
            </p>
            <br>

            <p>
                Tout d'abord, quelques r√®gles :
            </p>
            <div class="p-4 mb-6 border-l-4 border-blue-500 bg-blue-50">
                <div class="flex">
                    <div class="ml-3">
                        <ul class="text-sm text-blue-700">
                            <li>Seuls les adh√©rents du club alpin fran√ßais de Lyon Villeurbanne √† jour de leur licence peuvent emprunter et r√©server le mat√©riel du club via notre plateforme de r√©servation Loxya. Ce n'est pas possible avec des cartes d√©couvertes.</li>
                            <li>Il n'est pas possible d'emprunter du mat√©riel pour quelqu'un d'autre</li>
                            <li>Le mat√©riel doit √™tre emprunt√© pour une sortie collective officielle du club d√©pos√©e sur ce site internet, il n'est pas possible de louer du mat√©riel pour un usage en dehors de ces sorties.</li>
                            <li>Vous pouvez venir chercher le mat√©riel le jeudi pr√©c√©dent la sortie, et le restituer le mardi suivant, lors des permanences mat√©riel de 18h30 √† 20h.</li>
                            <li>Merci d'indiquer dans les notes additionnelles (lors de la validation de votre panier sur la plateforme) la sortie pour laquelle le mat√©riel est emprunt√©, ainsi que le nom de l'encadrant de la sortie.</li>
                            <li>La r√©servation doit √™tre accept√©e puis pay√©e, sans quoi mat√©riel ne pourra pas √™tre r√©cup√©r√©</li>
                            <li>Le mat√©riel doit √™tre rendu dans l'√©tat o√π il a √©t√© emprunt√© ou √† d√©faut, merci de signaler tout probl√®me rencontr√©.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <br>
            <p>
                Nous ne demandons pas de caution, mais en cas de perte ou d√©t√©rioration du mat√©riel, il vous sera demand√© de r√©gler les frais de r√©paration, ou la valeur de remplacement du mat√©riel concern√©.
            </p>
            <p>
                Merci.
            </p>

            <h2 class="bleucaf">Acc√®s √† la plateforme de r√©servation</h2>
            
            <p>
                Pour acc√©der √† cette plateforme de r√©servation, vous devez cr√©er un compte sur notre outil de gestion.
                Une fois votre compte cr√©√©, vous pourrez :
            </p>

            <div class="p-4 mb-6 border-l-4 border-blue-500 bg-blue-50">
                <div class="flex">
                    <div class="ml-3">
                        <ul class="text-sm text-blue-700">
                            <li>Vous connecter sur la plateforme Loxya</li>
                            <li>Consulter le mat√©riel disponible √† vos dates</li>
                            <li>Faire une demande de r√©servation</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="flex flex-col items-end space-y-4">
                {% if user.hasMaterielAccount() %}
                    <div class="info info-container" style="margin-right:2rem !important">
                        <img src="/img/inscrit-check.png" alt="" title="">
                        <div class="text-container">
                            Vous avez d√©j√† un compte avec l'email : <b>{{ user.email }}</b> 
                            cr√©√© le {{ user.materielAccountCreatedAt ? user.materielAccountCreatedAt.format('d/m/Y √† H:i') : '' }}<br>
                            Veuillez rechercher votre mot de passe dans vos emails.
                        </div>
                    </div>
                    <a href="{{ materiel_platform_url }}" target="_blank" class="nice2 blue">
                        üéí Acc√©der √† la plateforme
                    </a>
                {% elseif user.doitRenouveler %}
                    <div class="p-4 mb-6 border-l-4 border-red-500 bg-red-50">
                        <div class="flex">
                            <div class="ml-3">
                                <p class="text-sm text-red-700">
                                    ‚ö†Ô∏è Votre licence n'est pas valide. Veuillez renouveler votre adh√©sion pour acc√©der au service de r√©servation de mat√©riel.
                                </p>
                            </div>
                        </div>
                    </div>
                {% elseif errorMessages|length == 0 and successMessages|length == 0 %}
                    <p class="mb-4 text-sm text-gray-600">
                        La cr√©ation de votre compte et la r√©ception de vos identifiants / mot de passe par mail se feront instantan√©ment.
                    </p>
                    <p class="mb-4 text-sm text-gray-600">
                        Pensez √† bien noter ou enregistrer votre mot de passe. Il nous est impossible de le changer s'il venait √† √™tre perdu. Merci de faire attention.
                    </p>
                    <form method="post" action="{{ path('materiel_create_account') }}" class="w-full sm:w-auto">
                        <button type="submit" class="nice2 blue" style="font-size: 16px; padding: 8px 20px;">
                            ‚ú® Cr√©er mon compte
                        </button>
                    </form>
                {% endif %}
            </div>
            <br>

            <div class="mt-8 text-center">
                <a href="https://forms.clickup.com/42653954/f/18np82-775/1BKP6TIKU0RIYXCRWE" target="_blank" class="text-blue-600 hover:text-blue-800">
                    üöß Signaler un dysfonctionnement sur cet acc√®s ?
                </a>
            </div>
        </div>
    </div>
{% endblock %}