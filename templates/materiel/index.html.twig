{% extends 'base.html.twig' %}

{% block title %}Gestion du mat√©riel{% endblock %}

{% block body %}
    {# Stocker les messages flash dans des variables locales au d√©but du template #}
    {% set errorMessages = app.flashes('error') %}
    {% set successMessages = app.flashes('success') %}
    
    <div id="left1">
        <h1 class="page-h1">Gestion du mat√©riel</h1>
        <div class="main-type">
            {# Affichage des messages flash en haut de la page #}
            {% for message in errorMessages %}
                <div class="info info-container" style="margin-right:2rem !important">
                    <img src="/img/inscrit-check.png" alt="" title="">
                    <div class="text-container">{{ message }}
                    </div>
                </div>
            {% endfor %}
            
            {% for message in successMessages %}
                <div class="info info-container" style="margin-right:2rem !important">
                    <img src="/img/inscrit-check.png" alt="" title="">
                    <div class="text-container">{{ message }}
                    </div>
                </div>
            {% endfor %}

            <p>
                Le club dispose de mat√©riel pour vous aider √† acc√©der aux activit√©s.<br><br>
                Seuls les adh√©rents du club alpin francais de Lyon Villeurbanne √† jour de leur licence peuvent emprunter et r√©server le mat√©riel du club notre plateforme de r√©servation Loxya. Ce n'est pas possible avec des cartes d√©couvertes.<br><br>
                Il n'est pas possible de r√©server du mat√©riel pour quelqu'un d'autre.
            </p>

            <h2 class="bleucaf">Acc√®s √† la plateforme de r√©servation</h2>
            
            <p>
                Pour acc√©der √† cette plateforme de r√©servation, vous devez cr√©er un compte sur notre outil de gestion.
                Une fois votre compte cr√©√©, vous pourrez :
            </p>
            

            <div class="p-4 mb-6 border-l-4 border-blue-500 bg-blue-50">
                <div class="flex">
                    <div class="ml-3">
                        <p class="text-sm text-blue-700">
                            ‚Ä¢ Vous connecter sur la plateforme Loxya<br>
                            ‚Ä¢ Consulter le mat√©riel disponible √† vos dates<br>
                            ‚Ä¢ Faire une demande de r√©servation
                        </p>
                    </div>
                </div>
            </div>
            <div class="flex flex-col items-end space-y-4">
                {% if user.hasMaterielAccount() %}
                    <div class="info info-container" style="margin-right:2rem !important">
                        <img src="/img/inscrit-check.png" alt="" title="">
                        <div class="text-container">
                            Vous avez d√©j√† un compte avec l'email : <b>{{ user.email }}</b> 
                            cr√©√© le {{ user.materielAccountCreatedAt ? user.materielAccountCreatedAt.format('d/m/Y √† H:i') : '' }}<br>
                            Veuillez rechercher votre mot de passe dans vos emails.
                        </div>
                    </div>
                    <a href="{{ materiel_platform_url }}" target="_blank" class="nice2 blue">
                        üéí Acc√©der √† la plateforme
                    </a>
                {% elseif user.doitRenouveler %}
                    <div class="p-4 mb-6 border-l-4 border-red-500 bg-red-50">
                        <div class="flex">
                            <div class="ml-3">
                                <p class="text-sm text-red-700">
                                    ‚ö†Ô∏è Votre licence n'est pas valide. Veuillez renouveler votre adh√©sion pour acc√©der au service de r√©servation de mat√©riel.
                                </p>
                            </div>
                        </div>
                    </div>
                {% elseif errorMessages|length == 0 and successMessages|length == 0 %}
                    <p class="mb-4 text-sm text-gray-600">
                        La cr√©ation de votre compte et la r√©ception de vos identifiants / mot de passe par mail se feront instantan√©ment.
                    </p>
                    <form method="post" action="{{ path('materiel_create_account') }}" class="w-full sm:w-auto">
                        <button type="submit" class="nice2 blue" style="font-size: 16px; padding: 8px 20px;">
                            ‚ú® Cr√©er mon compte
                        </button>
                    </form>
                {% endif %}
            </div>

            <h2 class="bleucaf">Informations importantes</h2>
            
            <h3 class="bleucaf">Conditions d'emprunt</h3>
            <ul>
                <li>si la r√©servation n'est pas accept√©e / pay√©e, le mat√©riel ne peut pas √™tre r√©cup√©r√©</li>
                <li>La dur√©e maximale d'emprunt est de 7 jours</li>
                <li>Le mat√©riel doit √™tre rendu dans l'√©tat o√π il a √©t√© emprunt√©</li>
            </ul>

            <div class="mt-8 text-center">
                <a href="https://forms.clickup.com/42653954/f/18np82-775/1BKP6TIKU0RIYXCRWE" target="_blank" class="text-blue-600 hover:text-blue-800">
                    üöß Signaler un dysfonctionnement sur cet acc√®s ?
                </a>
            </div>
        </div>
    </div>
{% endblock %}