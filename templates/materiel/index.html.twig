{% extends 'base.html.twig' %}

{% block title %}Gestion du mat√©riel{% endblock %}

{% block body %}
    {# Stocker les messages flash dans des variables locales au d√©but du template #}
    {% set errorMessages = app.flashes('error') %}
    {% set successMessages = app.flashes('success') %}
    
    <div id="left1">
        <h1 class="page-h1">Gestion du mat√©riel</h1>
        <div class="main-type">
            {# Affichage des messages flash en haut de la page #}
            {% for message in errorMessages %}
                <div class="info info-container" style="margin-right:2rem !important">
                    <img src="/img/inscrit-check.png" alt="" title="">
                    <div class="text-container">{{ message }}
                    </div>
                </div>
            {% endfor %}
            
            {% for message in successMessages %}
                <div class="info info-container" style="margin-right:2rem !important">
                    <img src="/img/inscrit-check.png" alt="" title="">
                    <div class="text-container">{{ message }}
                    </div>
                </div>
            {% endfor %}

            <h2 class="bleucaf">Acc√®s √† la plateforme de r√©servation</h2>
            
            <p>
                Pour acc√©der √† notre plateforme de r√©servation de mat√©riel, vous devez cr√©er un compte sur notre outil de gestion.
                Une fois votre compte cr√©√©, vous pourrez :
            </p>
            <ul>
                <li>Consulter le catalogue de mat√©riel disponible</li>
                <li>R√©server du mat√©riel pour vos sorties</li>
                <li>G√©rer vos r√©servations en cours</li>
                <li>Consulter l'historique de vos emprunts</li>
            </ul>

            <div class="p-4 mb-6 border-l-4 border-blue-500 bg-blue-50">
                <div class="flex">
                    <div class="ml-3">
                        <p class="text-sm text-blue-700">
                            La cr√©ation de compte est automatique et instantan√©e. Vous recevrez vos identifiants par email.
                        </p>
                    </div>
                </div>
            </div>
            <div class="flex flex-col items-end space-y-4">
                {% if user.hasMaterielAccount() %}
                    <div class="p-4 mb-6 border-l-4 border-green-500 bg-green-50">
                        <div class="flex">
                            <div class="ml-3">
                                <p class="text-sm text-green-700">
                                    Vous avez d√©j√† un compte sur la plateforme de location de mat√©riel (cr√©√© le {{ user.materielAccountCreatedAt ? user.materielAccountCreatedAt.format('d/m/Y √† H:i') : '' }})
                                </p>
                                <a href="{{ materiel_platform_url }}" target="_blank" class="nice2 blue">
                                    üéí Acc√©der √† la plateforme
                                </a>
                            </div>
                        </div>
                    </div>
                {% elseif user.doitRenouveler %}
                    <div class="p-4 mb-6 border-l-4 border-red-500 bg-red-50">
                        <div class="flex">
                            <div class="ml-3">
                                <p class="text-sm text-red-700">
                                    ‚ö†Ô∏è Votre licence n'est pas valide. Veuillez renouveler votre adh√©sion pour acc√©der au service de r√©servation de mat√©riel.
                                </p>
                            </div>
                        </div>
                    </div>
                {% elseif errorMessages|length == 0 and successMessages|length == 0 %}
                    <form method="post" action="{{ path('materiel_create_account') }}" class="w-full sm:w-auto">
                        <button type="submit" class="nice2 blue" style="font-size: 16px; padding: 8px 20px;">
                            ‚ú® Cr√©er mon compte
                        </button>
                    </form>
                {% endif %}
            </div>

            <h2 class="bleucaf">Informations importantes</h2>
            
            <h3 class="bleucaf">Conditions d'emprunt</h3>
            <ul>
                <li>Le mat√©riel est r√©serv√© aux adh√©rents du club</li>
                <li>Les r√©servations doivent √™tre faites au minimum 48h √† l'avance</li>
                <li>La dur√©e maximale d'emprunt est de 7 jours</li>
                <li>Le mat√©riel doit √™tre rendu dans l'√©tat o√π il a √©t√© emprunt√©</li>
            </ul>
        </div>
    </div>
{% endblock %}